python: 2.7

matrix:
  env:
    - PACKAGE_VERSION="2.1.0"
  include:
  - os: linux
    dist: trusty
    compiler:
      - clang
      - clang++
    language: python
    env:
      global:
        - PACKAGE_VERSION="2.1.0"
        - MATRIX_EVAL="CC=clang-6.0 && CXX=clang++-6.0"
        - EXTRA_CXX_FLAGS="-stdlib=libstdc++-6-dev"
        - EXTRA_CXX_LINKER_FLAGS="-stdlib=libstdc++-6-dev"
        - EXTRA_LDFLAGS="-lstdc++"
        -  secure: "bMRgPbvksjJulsjQtBwCOspm1Imm3cMExThG4ns4HxaRPVCePogQ43T9pSVvw6u+PT3EfkNMCFakrGyCFQo1Wb8ZldnL0gj7PslrY/6OjxVWHeQrdQ+eYF+q386Ye32R3O4idIVIg9PW04qE6ecsksZxEemeW0oYtH9U9Wijp5rom7lAtOMyZOwRi3XDb7LEFcgS8AAHSz4Ko0CBEvWkVJYwB8ZtNBM2BIRtAOuklTsKlY07TygWfBS84f7/VK9VRGD0DfZHSgT3pm0EnB/P+kzpGZuM18A0uTUBIgHSfNMdwXz7etgqf4kIs6n+j4FYCMtGC3oUrMCVTmKYGvovLTA9yEWbRuPhNMF8Jgep0jV+VXSmeh+8qTnspNNaMIU+GVcrnbqi2W8+fU6MJTAgEl6RnXhYxthzJtPoZ6Ra7OcYU8L9idSDPTG9543gExSYX6rXBRBbVmcKy3aKHU8z0EhXP1VmYHew+8UXDXRn2CKStfAYd/eGB/Bui6f5GTFCXDZoEWzGKmCOUts7tGiCu3jZAU4VUPq63qA7XHC0clV0n4DAXVFtmYXxyOGXz/sE5R7Fp3tBDi+MatE1wXYf64yeXG321tHNJnU13zGw4LPdmy4BYh8g0OS2iEhFKog8nUWsVm4iUFnD57X4nFFc2UAYIBMQqB+Iu1Y4JxDMkqQ="
    before_install:
      - echo -n | openssl s_client -connect https://scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
      - sudo apt-get install -y libpcsclite-dev
      - eval "${MATRIX_EVAL}"
    addons:
      coverity_scan:
        project:
          name: "Holocrons/liblogicalaccess"
          description: "courge maker since 1884"
        notification_email: remi.wickuler@epitech.eu
        build_command_prepend: "export CC=/usr/bin/clang-6.0 ; export CXX=/usr/bin/clang++-6.0 ; mkdir build ; cd build ; conan create .. LogicalAccess/$PACKAGE_VERSION@Holocrons/$TRAVIS_BRANCH ; conan install .. -o LLA_BUILD_UNITTEST=True --build gtest --build OpenSSL --build libstdc++-6-dev"
        build_command: "conan build .."
        branch_pattern: $TRAVIS_BRANCH
      apt:
        update: true
        sources:
          - ubuntu-toolchain-r-test
          - llvm-toolchain-trusty-6.0
        packages:
          - clang-6.0
          - libc++-dev
          - libc++abi-dev
          - libstdc++-6-dev
    script:
      - echo courge

install:
  - pip install conan
  - conan user
