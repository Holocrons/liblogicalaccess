python: 2.7

matrix:
  env:
    - PACKAGE_VERSION="2.1.0"
  include:
  - os: linux
    dist: trusty
    compiler:
      - clang
      - clang++
    language: python
    env:
      global:
        - PACKAGE_VERSION="2.1.0"
        - MATRIX_EVAL="CC=clang-6.0 && CXX=clang++-6.0"
        - EXTRA_CXX_FLAGS="-stdlib=libstdc++-6-dev"
        - EXTRA_CXX_LINKER_FLAGS="-stdlib=libstdc++-6-dev"
        - EXTRA_LDFLAGS="-lstdc++"
        - secure: "Vu64jJMIXictl8mlTBGA9GSQaT53GWlVrMXjUgbFsA6tPzkmojmw7bTrVQI5bBhxMNLvGZg/Yh8GTv/pLJVCvjJomDGH6/Fie8XYA11nB+70LFwDFAWJkFNoJJIUuJuTmnssV67n8PquRwxfcmxzhcWsMpDSUazS2Br/0akSk4p1aJ1V9B0qpe3pI9L2amhQSU+xn6LyaMGj+vzh3lXDOFsDE6Fd8SwMTFi7ietUYR89EWkTWDJQE2LLKsepD0S7rF8FIySiiJuotUBuX7LuvFmg6DUTaSHHISFXQC3tgWtzji7oqNpgtsi3wjkGoNhH95B9VgXZf/wqanDggcdZP8GoDThMxT+uyZdpMfpWPfLu8A90llz18P8Xj8qS8PD9FcQcP1ZgerAhmtLSIkNp2mv2ju264EnyA7/IfkGh2UQ/VzRJN4ozIqyXQsC96n2N/1mgexfwjd7INm3Ct+Zyv6TdAczM5iOPYDWo5msqMCLHGdWoWr6ztbA5Mx7P6RJFcFFK3b5ZcUrFOmxeAuXRQWa2YLqxw0qrjMOB1cyjWYB2DE2M7lGd1wQ5ar0iey99GjH7ogF8pkx4VJDoWnYqB6Q9glvGebZL8vXVpa4xNJVWu3vhCx8gp7pxDQzY3VIITiQD13R9zCI3xFiHMw91xBpf14PN7GCU1WLWi1nj2CM="
    before_install:
      - echo -n | openssl s_client -connect https://scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
      - sudo apt-get install -y libpcsclite-dev
      - eval "${MATRIX_EVAL}"
    addons:
      coverity_scan:
        project:
          name: "liblogicalaccess"
          description: "courge maker since 1884"
        notification_email: remi.wickuler@epitech.eu
        build_command_prepend: "export CC=/usr/bin/clang-6.0 ; export CXX=/usr/bin/clang++-6.0 ; mkdir build ; cd build ; conan create .. LogicalAccess/$PACKAGE_VERSION@Holocrons/$TRAVIS_BRANCH ; conan install .. -o LLA_BUILD_UNITTEST=True --build gtest --build OpenSSL --build libstdc++-6-dev"
        build_command: "conan build .."
        branch_pattern: $TRAVIS_BRANCH
      apt:
        update: true
        sources:
          - ubuntu-toolchain-r-test
          - llvm-toolchain-trusty-6.0
        packages:
          - clang-6.0
          - libc++-dev
          - libc++abi-dev
          - libstdc++-6-dev
    script:
      - echo courge

install:
  - pip install conan
  - conan user
